# 기능
## 구현할 기능 목록
- [ ] 로또 구입 금액을 요청한다.
	- [ ] 구입금액을 입력해 달라는 메시지를 출력한다.
	- [ ] 사용자가 입력한 구입금액을 받는다.
		- [x] 구입 금액은 1,000원 단위로 입력받는다. 1,000원 단위로 나누어 떨어지지 않는 경우 예외 처리한다. 
- [ ] 발행한 로또 수량 및 번호를 출력한다.
	- [x] 로또 번호의 숫자 범위는 1~45까지이다.
	- [ ] 로또 번호는 오름차순으로 정렬하여 보여준다.
	- [ ] 중복되지 않는 6개의 숫자를 뽑는다.
- [ ] 당첨 번호를 요청한다.
	- [ ] 당첨 번호를 입력해 달라는 메시지를 출력한다.
	- [ ] 사용자가 입력한 당첨 번호들을 받는다.
		- [ ] 쉼표를 기준으로 입력받는다.
		- [ ] 잘못된 입력이 발생했을 경우 예외 처리한다.
- [ ] 보너스 번호를 요청한다
	- [ ] 보너스 번호를 입력해 달라는 메시지를 출력한다.
	- [ ] 사용자가 입력한 보너스 번호를 받는다.
		- [ ] 잘못된 입력이 발생했을 경우(로또 번호 실패와 더불어, 이미 입력받은 당첨번호인지도 확인) 예외 처리한다.
- [ ] 당첨 통계를 출력한다.
	- [ ] 구입한 로또 번호들과 입력한 당첨번호 및 보너스 번호를 기준으로 통계를 구한다.
	- [ ] 당첨 기준과 금액에 대해 구현한다.
		- 1등: 6개 번호 일치 / 2,000,000,000원
		- 2등: 5개 번호 + 보너스 번호 일치 / 30,000,000원
		- 3등: 5개 번호 일치 / 1,500,000원
		- 4등: 4개 번호 일치 / 50,000원
		- 5등: 3개 번호 일치 / 5,000원
	- [ ] 당첨 기준, 금액, 총 몇 개가 해당 기준에 속했는지를 보여준다.
	- [ ] 총 수익률을 보여준다.
		- [ ] 수익률은 소수점 둘째 자리에서 반올림한다.
		- [ ] 총 당첨 금액 / 구입 금액 * 100
- [ ] 중복되지 않는 6개의 숫자를 뽑는다.
## 지켜야 할 사항
- 사용자가 잘못된 값을 입력할 경우 `IllegalArgumentException`를 발생시키고, `[ERROR]`로 시작하는 에러 메시지를 출력 후 그 부분부터 입력을 다시 받는다.
	- `Exception`이 아닌 `IllegalArgumentException`, `IllegalStateException` 등과 같은 명확한 유형을 처리한다.
- 사용자 입력 시 `camp.nextstep.edu.missionutils.Console`의 `readLine()`을 활용한다.
- 랜덤 숫자 생성 시 `camp.nextstep.edu.missionutils.Randoms`의 `pickUniqueNumbersInRange()`를 활용한다.
- depth는 2까지만 허용한다.
- 메서드가 한 가지 일만 하도록 최대한 작게 만들어라.
- 메서드의 길이가 15라인을 넘어가지 않도록 구현한다.
- else, switch/case를 사용하지 않는다.
- Enum을 적용한다.
- 도메인 로직에 단위 테스트를 구현해야 한다.
- 핵심 로직과 UI 로직을 분리해 구현한다.
- 제공된 Lotto 클래스를 활용해 구현한다.
	- numbers 접근 제어자 변경 불가.
	- 필드 추가 불가.
	- 패키지 변경 가능.
	- 추가 기능 구현.
# 시도한 사항들
## TDD
코수타를 보며, `잘하기`가 아닌 `자라기`를 목적으로 삼았다. 따라서 TDD를 연습해보기로 했다.
TDD에 대한 책을 보고 싶었으나 당장 구할 수가 없었고, 일주일이라는 짧은 시간을 효율적으로 활용하기 위해 구글링을 통한 단편화된 개념을 습득했다.
구현할 기능 목록을 바탕으로 메서드들을 생각해 보고, 역할을 부여한 뒤 테스트 코드를 작성하기로 했다.
생각보다 쉽지 않겠지만.. 일단은 도전해보고, 정 안될 경우 마감 전날 급하게 돌아가는 쓰레기라도 만들어 볼 생각이다.
## 역할과 책임 나누기
- 구입금액을 입력받는다 - View
	- 구입금액 입력 요청 메시지를 출력한다 - outputView
	- 구입금액 입력을 받는다 - inputView
	- 받은 입력을 형변환하여 반환한다 - inputView
- 입력받은 구입금액에 따라 로또를 구매한다 - 로또 구매기
	- 입력 금액이 단위 금액으로 나누어 떨어지는지 확인한다 - 로또 구매기
	- 몇 개의 로또를 구매하는지 확인한다 - 로또 구매기
- 구매한 로또 갯수만큼 로또를 발행한다 - 로또 발행기
	- 1부터 45까지의 범위를 갖는 로또 번호들을 생성한다 - 로또 번호
	- 로또 번호들을 겹치지 않게 6개 생성한다 - 로또
	- 로또들을 묶어 발행한다 - 로또 발행기
- 로또 묶음에 대한 정보를 출력한다 - outputView
	- 로또 묶음의 갯수를 출력한다. - outputView
	- 로또들의 번호를 출력한다 - outputView
- 당첨 번호를 입력받는다 - View
	- 당첨번호 입력 메시지를 출력한다 - outputView
	- 당첨 번호를 입력받는다 - inputView
	- 입력받은 번호를 쉼표 기준으로 나누어 반환한다 - inputView
- 보너스 번호를 입력받는다 - View
	- 보너스 번호 입력 메시지를 출력한다 - outputView
	- 보너스 번호를 입력받는다 - inputView
	- 보너스 번호를 형변환하여 반환한다 - inputView
- 당첨 통계를 계산한다 - 당첨 통계 계산기
	- 로또 번호와 보너스 번호를 통해 당첨 로또를 만든다 - 당첨 로또
	- 로또 묶음 내의 로또 번호들과 당첨 번호를 비교하여 당첨을 확인한다 - 당첨 확인기
	- 확인한 당첨 정보로 통계를 작성한다 - 당첨 통계 계산기
- 당첨 통계를 출력한다 - View
	- 당첨 통계에 대한 정보를 출력한다 -  outputView
## 실패하는 테스트 코드 작성하기
## 테스트 코드를 성공시키기 위한 실제 코드 작성하기
## 중복 코드 제거, 일반화 등의 리팩터링 수행하기
# 고민한 사항들
## TDD
당돌하게 TDD를 해보자고 했건만, 시작부터 고민이 마구 차올랐다.
어디부터 손을 대야 할 지 모르겠다..
기능 구현 목록을 정리하면 어떤 부분에 무엇을 추가해야 할 지 떠오를 것 같았는데, 말처럼 쉽지가 않았다.
프로그래밍에 대해 아무것도 모르던 시절로 돌아간 기분이 들었다. 내가 지금 뭘 할 수 있지? 어떻게 해야하지?
우선 역할과 책임을 참고하여 실패하는 테스트부터 차례대로 짜보기로 했다.

목록의 위쪽부터 시작하여 로또 구매기(LottoShop)에 대해 테스트코드를 작성했다.
커밋을 작성하고 난 후 로또 구매기 클래스를 작성하는데, 로또 구입에 대해 코드를 작성하려면 로또 클래스가 필요했다. 다행히 우테코에서 제공해 준 로또 클래스가 있었으나, 'TDD의 흐름이 순차적으로 흘러가면 안되겠구나'하는 깨달음을 얻었다.
따라서 가장 작은 클래스(의존성이 제일 적은 클래스)를 생각했고, 로또 번호 클래스에 대한 테스트코드를 먼저 작성해야겠다는 생각이 들었다.

막상 작성하고 나니 고민할 것들이 또 늘어났다.
- 로또 구매기와 로또 발행기를 따로 적었는데, `LottoShop`이란 이름은 로또를 구매 및 발행에 대해 모두 책임을 지는 것처럼 느껴진다. 실제로 로또 구매기에 대해서만 작성하려 했다면 `금액 지불 -> 발행할 로또 갯수 반환`까지만 이뤄져야 하는데, 로또 발행까지 해야 한다는 생각에 로또 클래스까지 고려하게 되었다. 그러므로 `LottoShop`은 로또 구매기와 로또 생성기를 내부적으로 포함하는 클래스가 되어야 하며, 로또 구매기는 직원처럼 금액을 받고 로또 구매 개수를 반환하며, 로또 생성기가 로또 번호로 이루어진 로또를 개수만큼 만들어 반환해야 했다.
- 로또는 로또 번호로 이루어져야 한다. 그러나 우테코에서 제공된 기본 클래스는 Integer 리스트로 이루어져 있다. 그러나 좋은 구조를 가져가기 위해선 Integer 대신 직접 작성한 LottoNumber를 사용하는 게 더 낫다는 판단이 되었고, 필드를 추가하거나 접근 제어자를 변경하는 게 아니므로 적용해보기로 했다.

로또 발행기에 대해 테스트코드를 작성하려 보니 로또 구매기 역할로 만들었던 로또 매장 직원이 단위 금액을 지니고 있는 게 이상하다고 판단되었다. 물론 로또 매장 직원은 구매자의 돈을 받고 돈에 대해 검증해야 하지만, 매장 직원이 로또의 단위 금액을 관리하는 게 맞을까? 로또 발행기가 알고 있어야 하는 정보가 아닐까?
로또 매장 직원이라는 이름이 내게 혼란을 주는 것만 같았다. 어디까지나 로또 매장 직원은 **로또 구매기** 역할이다.
로또를 구매하기 앞서 금액 부분을 확인하고, 로또 발행기에게 몇 개를 생성하면 되는지 넘겨주는 역할이다.
잘못된 네이밍으로 인해 흐름을 잘못 가져와버렸다. 이름을 수정하고, 각각의 정확한 역할에 대해 머릿속에 넣어놔야 할 것 같다.

로또 발행기는 로또를 생성하는 책임을 지니고 있다. 다만 숫자의 범위는 로또 번호에서 가져와야 하고, 몇 개를 선택할 지는 로또에서 가져와야 한다.
물론 둘 다 상수기에 public으로 전환하여 참조할 수는 있지만, 해당하는 구조가 옳은지 생각해봐야 한다.
만약 TDD가 아니었다면 로또 자체에 정적 팩터리 패턴을 적용했을 것이다. 해당 패턴을 적용하지 않아야 할 특별한 이유가 있을까?
로또 발행기는 로또의 묶음을 반환한다. 즉, 로또 생산을 하긴 하나 제일 중요한 건 로또의 목록을 생성하여 묶음으로 반환하는 것이다.
따라서 로또는 스스로 랜덤 생성할 정적 팩터리 메서드를 지니고, 로또 발행기가 해당 메서드를 활용하는 게 책임의 범위에 더 알맞다고 생각했다.
또한, 클래스명을 더 명확히 하여 로또 구매기 및 발행기에 로또 묶음에 대한 네이밍을 적용해야겠다.

당첨 확인기의 역할은 당첨 번호와 구매한 로또 묶음들을 비교하여 당첨 정보를 반환하는 것이다.
다만 당첨 번호에서 값을 가져오고, 로또 번호들을 가져오는 게 과연 좋은 구조일까 하는 고민이 된다.
값을 얻어와 비교하는 것보다, 해당 클래스에게 비교할 책임을 주는 게 어떨까?
당첨 번호에게 로또 묶음들을 전달하고, 당첨 번호 내의 로또 객체는 전달받은 로또 객체들과 얼마나 겹치는지 확인한다(이는 로또 클래스에서 정의한다). 보너스 번호 또한 로또 번호들 중에 자신이 포함되어있는지 확인한다(로또 번호가 책임을 지니고 있어야 할까? 혹은 보너스 번호라는 클래스를 따로 생성해서 진행해야 할까?)
클래스의 내부 구조는 추후 생각하고, 당첨 통계기의 구조를 어떻게 할 것인지 생각해 봐야 한다.
당첨 기준을 enum으로 작성한다 하면, 일치한 로또 번호 횟수를 통해 당첨 기준을 반환하는(+ 5개 숫자 일치할 때 2등인지 3등인지 구분할) 무언가가 있어야 한다.
enum 내에 정적 메서드로 작성하는 게 제일 좋지 않을까? enum 구성에 변화가 생겼을 때 빠르게 대응할 수 있게끔 말이다.
다만.. 몇 개의 숫자가 일치하는지에 대해 등수가 나뉘어질텐데, 해당 enum 객체에 일치 개수를 적어둬야 하는지 의문이다. 또한 보너스 볼 일치 유무도 넣어야 하는지도 굉장히 조심스럽다.
enum은 기본적으로 평행하게 나열된 것들을 배치해야 한다고 알고있다. 등수가 그러한 예시이다. 그러나 보너스 번호의 유무때문에 고민이 된다..
만약 해당 로또가 아주 특수한 경우가 생겨, 3개 일치 + 보너스 번호 일치 유무까지도 파악해야 한다면?
그러면 enum에 해당 객체를 적어넣는 게 맞고, 그렇다면 일치 개수와 보너스 번호로 당첨 금액을 찾아가는 방식이 되어야 한다..
당첨 금액을 찾아가는 방식이라는 건, 어쩌면 당첨 순위와 당첨 금액이 별개라는 게 아닐까?
로또 번호 5개 일치, 보너스 번호 일치 -> 2등이라는 치환이 가능하지만 30,000,000원 -> 2등이라고 치환되지는 않는다. 오히려 2등 -> 30,000,000원으로 치환이 되어야 한다.
물론 관련이 있는 값이기에 Enum의 필드로 작성해도 괜찮겠으나, 실제 로또의 경우 매 주 당첨금액이 변한다.
시뮬레이션으로 추상화한다면 필드 값이, 아니라면 따로 두는 게 맞을 것이다..
더 깊게 구조를 짠다면, 로또를 맞춘 개수를 통해 2등과 3등을 제외한 등수를, 보너스 번호로 인해 2등과 3등을 구하고 해당 금액을 받아가야 한다. 
해당 구조에서 평행한 값들은 로또 맞춘 개수와 금액이다.
로또의 등수를 Enum으로 잡는 게 아닌, 맞춘 개수와 금액을 Enum으로 잡고 그 둘의 연관관계를 지니게끔 구조를 작성하는 게 더 낫지 않을까?
계속 고민이 제자리를 빙빙 도는 느낌이다. 등수를 기준으로 할 것인가, 당첨 설계를 기준으로 할 것인가?
이 부분은 정말 정해진 답이 없는 것 같다. 다만 당첨 기준과 당첨금을 나누고, 이 둘을 연결시켜주는 구조를 갖는 게 좀 더 변화에 빠르게 대응할 수 있을 것 같다는 생각이 들었다.
# 느낀 점
**TDD를 통해 좋은 설계가 만들어지는 것이 아니다. 좋은 설계를 했을 때 TDD가 쉬워지는 것이다.**
아무래도 TDD에 대해 너무 가볍게 생각한 것 같다. TDD가 내게 어려운 걸로 보아, 좋은 설계를 구상하는 게 먼저인 것 같다.
테스트가 개발을 주도해야 했다. 테스트를 통과할 만큼만의 코드를 작성해야 했는데, 테스트를 먼저 작성하고 생각해 둔 로직을 작성하는 식으로 개발을 진행했다. 진정한 TDD를 하기엔 정말 어려운 일일 것 같다.